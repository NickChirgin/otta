## Сервис по сокращению ссылок.
### Требования к сервису:  
Ссылка должна быть:  
— Уникальной; на один оригинальный URL должна ссылаться только одна сокращенная ссылка;  
— Длиной 10 символов;  
— Из символов латинского алфавита в нижнем и верхнем регистре, цифр и символа _ (подчеркивание).  

### Алгоритм сокращения ссылки:
Представим себе латинский алфавит вместе с цифрами [a-zA-Z0-9]. Он содержит 62 буквы. И будем использовать "_" подчеркивание в качестве пустого символа, когда длина нашей ссылки
будет меньше 10.
Возьмем автоматически генерируемый числовой ключ, например, id в PostgreSQL.

Для примера возьмем число 148<sub>10</sub>(148 c основанием 10).  
Теперь нужно преобразовать 148<sub>10</sub> в X<sub>62</sub> (основание 62).

148<sub>10</sub> = 2×62<sup>1</sup> + 24×62<sup>0</sup> = [2,24]  
Теперь отобразим индексы 2 и 24 на свой алфавит. Вот как может выглядеть отображение (например, с помощью массива):
```
0  → a
1  → b
...
24 → y
25 → z
...
52 → 0
61 → 9
```
С помощью 2 → c и 24 → y мы получим cy<sub>62</sub> в качестве сокращенного URL.  
http://ozon.it/cy

### Как развернуть сервис
1. Склонируйте репозиторий
```
git clone https://github.com/NickChirgin/otta.git
```
2. Создайте .env файл для работы PostgreSQL  
Пример .env файла
```
DB_USER=postgres
DB_PASSWORD=postgres
DB_NAME=ozon
DB_HOST=${pwd}-postgre-1
```
3. Сервис может работать как с PostgreSQL, так и с In-memory DB (в качестве in memory решения выбрал библиотеку memdb)  
По умолчанию сервис работает с постгре, но это можно поменять, добавив флаг "-memory" в Dockerfile, чтобы получилось:  
```
CMD go run cmd/main.go -memory
```
4. Запустить докер контейнер командой:  
```
docker compose up --build
```

В качестве теста сервиса можно использовать Postman, но чтобы сделать запрос нужно узнать ip контейнера.  
Для этого используем команду:
```
docker inspect \                       
  -f '{{range.NetworkSettings.Networks}}{{.IPAddress}}{{end}}' ID_OR_CONTAINER_NAME
```

Сервис написан с помощью gRPC протокола и имеет два метода:  
1. Метод TinyURL, который будет сохранять оригинальный URL в базе и возвращать сокращённый.
2. Метод FullURL, который будет принимать сокращённый URL и возвращать оригинальный.  
### Пример работы сервиса
![Пример работы сервиса](https://raw.githubusercontent.com/NickChirgin/otta/feature/gif/ezgif.com-video-to-gif.gif)
